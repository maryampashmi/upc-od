<div ng-controller="SourceOverview">
  <div class="pull-right">
    <a ng-href="{{downloadLink}}" class="btn btn-default" ng-click="updateDownloadLink()" target="_blank" ng-href ng-disabled="state != 'ready'">
      <span class="glyphicon glyphicon-cloud-download"></span>
      Download
    </a>
    <button class="btn btn-default" ng-click="reload()" ng-disabled="state == 'loading'">
      <span class="glyphicon glyphicon-refresh"></span>
      Reload
    </button>
  </div>
  <h1>Data Sources</h1>
  <div class="alert alert-info" ng-show="state == 'loading'">
    Loading...
  </div>
  <div class="alert alert-warning" ng-show="state == 'error'">
    Unable to retrieve the list of sources from the server.<br>
    <a ng-click="reload()">Retry</a>
  </div>
  <div ng-show="state == 'ready'">
    <p class="input-group">
      <span class="input-group-addon"><span class="glyphicon glyphicon-filter"></span></span>
      <input type="text" ng-model="sourcesFilter" class="form-control" id="sourcesFilter">
    </p>
    <section class="panel panel-default" ng-repeat="source in filteredSources = (sources | filter:{name:sourcesFilter})" ng-class="{deleting: deleting[source._id]}">
      <div class="panel-heading">
        {{source.name}}
        <div class="pull-right">
          <a href="/sources/edit/{{source._id}}"><span class="glyphicon glyphicon-pencil"></span> Edit</a>
          |
          <a ng-click="deleteSource(source._id)"><span class="glyphicon glyphicon-trash"></span> Delete</a>
        </div>
      </div>
      <div class="panel-body">
        Module: {{source.module}}<br>
        Config:
        <pre>{{source.config | json}}</pre>
      </div>
    </section>
    <section ng-show="filteredSources.length == 0" class="well">
      No sources found...
    </section>
  </div>
  <p>
    <a class="btn btn-primary btn-block" href="/sources/create">Add a new source</a>
  </p>
</div>

